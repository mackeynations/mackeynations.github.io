---
title: "Computational approaches to grid cell discovery: Background"
excerpt_separator: "<!--more-->"
categories:
  - Grid cells
tags:
  - grid cells
  - pattern discovery
  - self-supervised learning
---

# *In vivo*: grid cells in mammals
Grid cells were first described in Hafting et al.'s celebrated 2005 paper [Microstructure of a spatial map in the entorhinal cortex](https://www.nature.com/articles/nature03721), who recorded activation rates of neurons in the medial Entorhinal Cortex (mEC) and compared those activations to the rats' physical location in space. Much work had previously been conducted in the hippocampus, where *place cells* exist. Place cells are neurons which preferentially fire at a sporadic collection of positions in any given room. There is no clear rhyme nor rhythm in the positions that place cells fire, taking some time to "settle" on their preferred firing locus. What place cells represent is a matter of some debate: one of the more popular explanations today is that place cells are simply memory, activating as specific memories are recalled as reference for each position in space (the hippocampus is known to be related to memory formation, as was famously discovered in [patient HM](https://en.wikipedia.org/wiki/Henry_Molaison). The relative geometry of place cells is not preserved between different rooms, but seems to be rebuilt from scratch. (And there's research into this as well, for instance, place cells that cofire during REM sleep are more likely to cofire during exploration of a new room immediately upon waking, but this is a whole new can of worms.) All of this is to say: place cells are neat and were the only navigation toy that neuroscientists had for about 20 years, but they lack any clear descriptions. This is what made the discovery of grid cells so astounding: they have very clear structure and uses in navigation. 

<!--more-->

Grid cells preferentially fire along a hexagonal grid (or a triangular grid, the two are formally dual). 

| ![Hafting](/assets/hafting_grid.png) |
|:--:|
|*image from Hafting et al., Microstructure of a spatial map in the entorhinal cortex. The image displays the position of the cells studied in Hafting et al.'s paper in (a). (b) shows a hexagonal firing field of recorded grid cells, and an autocorellogram which emphasizes the hexagonal structure of the system. (c) and (d) detail the angles observed in the firing fields.*|

The hexagonal grid at which the grid cells fire at is strikingly geometric. This fact extends to the organization of grid cells themselves: grid cells have been shown to operate in a discrete set of *grid modules*: each grid module is a collection of grid cells with identical scales, differing only in phase. (That is, they have the same width between different firing fields, but the firing fields are offset from one another.) The collection of grid modules have different scales, with a ratio of approximately 1.4 between the different modules.  

This large collection of extemely orderly traits has resulted in intense interest in the mechanics of grid cell function from computational neuroscientists. Mechanically, grid cells are believed to have internal inhibitory connections within each module. These connections have the geometry of a "twisted torus." (This is the neuroscience term, a mathematician would say that they reflect the metric structure on the elliptic curve $\mathbb{C}/\langle 1, \frac12 + \frac{\sqrt{3}{2}i\rangle$.) I won't go into the details here, as they aren't terribly important for anything I will discuss, but [this paper by Burak & Fiete](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1000291) goes into the weeds. 

One interesting feature of this design is that which subset of neurons in a grid module are firing at any given time is highly regular, with those coactivations forming a torus. This is a very non-dense, so the set of different locations that the grid cells can distinguish is much smaller than a system like place cells, where any set of cells can cofire. However, the highly structured system lends the system error correction properties: if one random grid cell fires (or fails to fire) incorrectly, the brain can infer "true location" by projecting the set of firing neurons onto the nearest position on the torus.  

# So why grid cells?
Why do mammal brains have grid cells? What are they used for, and why do they have the form they do? Many different proposals and theories have been suggested over the last 20 years, and these are a few of my favorites:

 1. Error correction: As noted at the end of the previous section, grid cells of a single grid module cofire on a 2 dimensional submanifold of $\mathbb{R}^n$, where $n$ is the number of cells. By operating on a submanifold, the grid module is highly resistant to noise. We can model noise as being normally distributed for each neuron. If at position $x$ the grid cells have firing activity $v$, and the agent takes a step $\Delta x$, the update to grid cell firing activity will be $v + \Delta v + s$, where $s$ is sampled from the normal distribution $N(0, \sigma)$. However, the firing activity can then be regressed to the nearest point on the torus, projecting the error from $n$ dimensions to 2 dimensions. All errors that occured orthogonally to the manifold will be lost in the projection. 
 2. Extensibility: The collection of multiple grid modules allows us to distinguish a wide variety of spaces while maintaining a fine-grained representation of space. It was suggested that this extensibility could be maximized by having grid modules with relatively prime scale ratios, as is suggested by the Chinese remainder theorem.[^1]
 3. Dead reckoning: Grid cells are highly geometric, which allows them to compute position updates in orderly ways. You've experienced this whenever you've tried to navigate around your house at night without turning any of the lights on: just by judging how long of steps you've taken, you have a decent guess for where you are in your house. 
 4. Vectorial representation: Before grid cells were discovered, some authors proposed that place cells could be used to plan a path between two points: for instance, we could treat each place cell as a vertex, put edges between place cells that cofire, and use Dijkstra's algorithm to compute a path from place cell A to place cell B. The fact that place cells can cofire is inconvenient for this theory, but probably is a manageable computational problem. In terms of making a map of space though, this is inconvenient. Either one must memorize the relative directions between every pair of chosen locations (which requires memory that grows $O(n^2)$, where $n$ is the number of chosen locations), or one must memorize a graph and perform a reasonably complicated search to navigate. Grid cells, however, offer a vectorial (more precisely, an affine) representation of space: instead of memorizing the relative positions of of every location, or keeping track of a highly complex graph, the place-grid matrix maps each place cell to a location in grid-space. Then distance and direction between two points can be computed essentially by subtraction. This requires only $O(n)$ memory and $O(1)$ computation to travel from place A to place B. 
 5. Grid cells as an auto-encoder: one interesting set of papers has argued that grid-analogues can be found in humans while [performing non-navigation tasks](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5248972/). (Here by "analogues" I mean that this is analysis of fMRI data, rather than electrodes which can trace activity of single neurons. The scientific community frowns on unnecessary invasive brain surgeries in humans.) 
  - In essence, this view of grid cells 




[^1]: Taken to its inevitable conclusion, this proposal would suggest using irrational scale ratios. Indeed, there's even a "best" irrational ratio, which is the irrational number furthest from any rational number. (Furthest here requires some definition, since rational numbers are dense in the reals. We mean the irrational number $x$ which maximizes $\lim_{n \to \infty} n|x - c(x, n)|$, where $c(x, n)$ is the rational number closest to $x$ whose denominator is no greater than $n$. Good approximations are made by taking the continued fraction of $x$, and abbreviating it when a large number occurs. The "most irrational number" could therefore fairly be called $1 + \frac{1}{1 + \frac{1}{1 + ...}}$, which is actually our old friend the golden ratio. Perceptive readers will remember that the observed ratio is actually approximately 1.4 though! Whence the contradiction? The relatively prime theory of grid module scales is no longer widely believed: the problem is that there is a direct tradeoff between extensibility and error correction. 

When two grid modules are being used jointly, the realized cofiring space is a two dimensional submanifold of the product of the two tori. The more space the submanifold covers withing the product of tori, the more extensible the system. We can perform error correction on this submanifold, as we did for the torus. However, we can only correct errors if they are smaller than half the auto-separation of the submanifold embedding in $(S^1)^4$. This is really easy to see with an example: Let's suppose we're trying to distinguish integers on the number line, for an easier example, by observing the integer modulo two other integers. We could distinguish with high precision by using two large, relatively prime numbers, say 12 and 17. By observing $n \pmod{12}$ and $n \pmod{17}$ we can distinguish every number between 1 and $12\times 17 = 204$. That's pretty good! However, if we make a mistake when calculating, we're out of luck: 51, for example, corresponds to the coordinates (3, 0). If we make a mistake and calculate (2, 0), then we would identify the number 170, absolutely nowhere close to the true 51 value. 
